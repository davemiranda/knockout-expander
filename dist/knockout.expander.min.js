/*=============================================================================
	Author:			David Miranda - @davemiranda								
	License:		MIT (http://opensource.org/licenses/mit-license.php)		
																				
	Description:	KnockoutJS binding to expand and collapse elements.			
===============================================================================
*/
!function(a){"function"==typeof require&&"object"==typeof exports&&"object"==typeof module?a(require("knockout"),exports):"function"==typeof define&&define.amd?define(["knockout","exports"],a):a(ko)}(function(a){function b(b,c){function d(){h.addClass("expanded").removeClass("collapsed"),j.addClass("expanded").removeClass("collapsed"),k.hide(),l.show(),i.stop(!0,!1).animate({"max-height":i[0].scrollHeight+"px"},r),m=!0,c.accordion(g)}function e(a){h.addClass("collapsed").removeClass("expanded"),j.addClass("collapsed").removeClass("expanded"),l.hide(),k.show(),a||!m?i.css("max-height",o):(i.css("max-height",i[0].scrollHeight+"px"),i.stop(!0,!1).animate({"max-height":o},c.animate)),m=!1}function f(){m?e():d()}var g=this,h=$(b),i=null,j=null,k=null,l=null,m=!1,n=null,o=null,p={name:"",template:null,collapsedHeight:0,animate:{animate:"swing",duration:400},tolerance:50,accordion:a.observable(null)};if(c=$.extend(!0,p,c),c.template){var q=b.innerHTML;h.html($("#"+c.template).html()),h.find("[data-expander-content]").eq(0).html(q)}var r=$.extend({complete:function(){i.css("max-height","none")}},c.animate);c.accordion.subscribe(function(a){null!==a&&a!==g&&e()}),g.elementReady=function(){i=h.find("[data-expander-content]").eq(0),j=h.find("[data-expander-toggles]").eq(0),k=j.find("[data-expander-expand]").eq(0),l=j.find("[data-expander-collapse]").eq(0);var a=j.find("[data-expander-toggle]").eq(0);if(i.css("overflow","hidden"),isNaN(c.collapsedHeight)){var b=i.find(c.collapsedHeight).eq(0).position();n=b?b.top:Number.MAX_VALUE}else n=c.collapsedHeight;o=n+"px",i.outerHeight(!0)>n+c.tolerance?(i.css({"max-height":o}),k.click(function(a){a.preventDefault(),d()}),l.click(function(a){a.preventDefault(),e()}),a.click(function(a){a.preventDefault(),f()}),e(!0)):j.hide()}}a.bindingHandlers.expander={init:function(a,c){var d=c()||{},e=new b(a,d);setTimeout(function(){e.elementReady&&e.elementReady()},1)}}});