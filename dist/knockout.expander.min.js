/*=============================================================================
	Author:			David Miranda - @davemiranda								
	License:		MIT (http://opensource.org/licenses/mit-license.php)		
																				
	Description:	KnockoutJS binding to expand and collapse elements.			
===============================================================================
*/
!function(a){"function"==typeof require&&"object"==typeof exports&&"object"==typeof module?a(require("knockout"),exports):"function"==typeof define&&define.amd?define(["knockout","exports"],a):a(ko)}(function(a){function b(b,c){function d(){i.addClass("expanded").removeClass("collapsed"),k.addClass("expanded").removeClass("collapsed"),l.hide(),m.show()}function e(){i.addClass("collapsed").removeClass("expanded"),k.addClass("collapsed").removeClass("expanded"),m.hide(),l.show()}function f(){d(),j.stop(!0,!1).animate({"max-height":j[0].scrollHeight+"px"},q),c.accordion(h)}function g(){e(),j.css("max-height",j[0].scrollHeight+"px"),j.stop(!0,!1).animate({"max-height":o},c.animate)}var h=this,i=$(b),j=null,k=null,l=null,m=null,n=null,o=null,p={name:"",template:null,collapsedHeight:0,animate:{animate:"swing",duration:400},tolerance:50,accordion:a.observable(null),expanded:a.observable(!1)};c=$.extend(!0,p,c);var q=$.extend({complete:function(){j.css("max-height","none")}},c.animate);if(c.template){var r=b.innerHTML;i.html($("#"+c.template).html()),i.find("[data-expander-content]").eq(0).html(r)}c.accordion.subscribe(function(a){null!==a&&a!==h&&c.expanded()&&c.expanded(!1)}),c.expanded.subscribe(function(a){a?f():g()}),h.elementReady=function(){j=i.find("[data-expander-content]").eq(0),k=i.find("[data-expander-toggles]").eq(0),l=k.find("[data-expander-expand]").eq(0),m=k.find("[data-expander-collapse]").eq(0);var a=k.find("[data-expander-toggle]").eq(0);if(isNaN(c.collapsedHeight)){var b=j.find(c.collapsedHeight).eq(0).position();n=b?b.top:Number.MAX_VALUE}else n=c.collapsedHeight;o=n+"px",j.outerHeight(!0)>n+c.tolerance?(l.click(function(a){a.preventDefault(),c.expanded(!0)}),m.click(function(a){a.preventDefault(),c.expanded(!1)}),a.click(function(a){a.preventDefault(),c.expanded(!c.expanded())}),j.css("overflow","hidden"),c.expanded()?d():(e(),j.css("max-height",o))):k.hide()}}a.bindingHandlers.expander={init:function(a,c){var d=c()||{},e=new b(a,d);setTimeout(function(){e.elementReady&&e.elementReady()},1)}}});