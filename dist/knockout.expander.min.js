/*=============================================================================
	Author:			David Miranda - @davemiranda								
	License:		MIT (http://opensource.org/licenses/mit-license.php)		
																				
	Description:	KnockoutJS binding to expand and collapse elements.			
	Version:	    0.0.2                              		   	
===============================================================================
*/
!function(a){"function"==typeof require&&"object"==typeof exports&&"object"==typeof module?a(require("knockout"),exports):"function"==typeof define&&define.amd?define(["knockout","exports"],a):a(ko)}(function(a){function b(b,c,d){function e(){j.addClass("expanded").removeClass("collapsed"),l.addClass("expanded").removeClass("collapsed"),m.hide(),n.show()}function f(){j.addClass("collapsed").removeClass("expanded"),l.addClass("collapsed").removeClass("expanded"),n.hide(),m.show()}function g(){e(),k.stop(!0,!1).animate({"max-height":k[0].scrollHeight+"px"},r),c.accordion(i)}function h(){f(),k.css("max-height",k[0].scrollHeight+"px"),k.stop(!0,!1).animate({"max-height":p},c.animate)}var i=this,j=$(b),k=null,l=null,m=null,n=null,o=null,p=null,q={name:"",template:null,collapsedHeight:0,animate:{animate:"swing",duration:400},tolerance:50,accordion:a.observable(null),expanded:a.observable(!1)};c=$.extend(!0,q,c),a.isObservable(c.expanded)||(c.expanded=a.observable(c.expanded));var r=$.extend({complete:function(){k.css("max-height","none")}},c.animate),s=c.template;if(s){var t="object"==typeof s,u=t?s.name:s;if("string"==typeof u){var v=b.innerHTML;j.html($("#"+u).html()),j.find("[data-expander-content]").eq(0).html(v),t&&$.extend(!0,d,s.data)}}c.accordion.subscribe(function(a){null!==a&&a!==i&&c.expanded()&&c.expanded(!1)}),c.expanded.subscribe(function(a){a?g():h()}),i.elementReady=function(){var a=j.find("[data-expander-content]");k=a.length>0?a.eq(0):j,l=j.find("[data-expander-toggles]").eq(0),m=l.find("[data-expander-expand]").eq(0),n=l.find("[data-expander-collapse]").eq(0);var b=l.find("[data-expander-toggle]").eq(0);if(isNaN(c.collapsedHeight)){var d=k.find(c.collapsedHeight).eq(0).position();o=d?d.top:Number.MAX_VALUE}else o=c.collapsedHeight;p=o+"px",k.outerHeight(!0)>o+c.tolerance?(m.click(function(a){a.preventDefault(),c.expanded(!0)}),n.click(function(a){a.preventDefault(),c.expanded(!1)}),b.click(function(a){a.preventDefault(),c.expanded(!c.expanded())}),k.css("overflow","hidden"),c.expanded()?e():(f(),k.css("max-height",p))):l.hide()},d.expanded=c.expanded}a.bindingHandlers.expander={init:function(a,c,d,e,f){var g=c()||{},h=new b(a,g,f);setTimeout(function(){h.elementReady&&h.elementReady()},1)}},a.extenders.expander=function(b,c){var d=b();return d.expanded=a.observable(!!c),d.expand=function(){d.expanded(!0)},d.collapse=function(){d.expanded(!1)},d.toggle=function(){d.expanded(!d.expanded())},b}});